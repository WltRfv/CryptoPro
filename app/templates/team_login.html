{% extends "base.html" %}

{% block content %}
<div style="max-width: 600px; margin: 40px auto;">
    <div class="card" style="text-align: center;">
        <h1>üöÄ CryptoPro –ö–æ—à–µ–ª–µ–∫</h1>
        <p style="color: #667eea;">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—Ö–æ–¥ –ø–æ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏</p>
    </div>

    <div class="card">
        <h2>üîê –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>

        <!-- –®–∞–≥ 1: –í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è challenge -->
        <form method="POST">
            <input type="hidden" name="generate_challenge" value="1">

            <div class="form-group">
                <label for="member_name">–í–∞—à–µ –∏–º—è:</label>
                <select id="member_name" name="member_name" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –∏–º—è</option>
                    <option value="–°–∞–º–æ–Ω–æ–≤">–°–∞–º–æ–Ω–æ–≤</option>
                    <option value="–ì–∞–ª–∫–∏–Ω–∞">–ì–∞–ª–∫–∏–Ω–∞</option>
                    <option value="–ú–æ—Ü–∏–ø–∞–Ω">–ú–æ—Ü–∏–ø–∞–Ω</option>
                    <option value="–ò—Å–º–∞–π–ª–æ–≤">–ò—Å–º–∞–π–ª–æ–≤</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;">
                üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Challenge
            </button>
        </form>

        <!-- –®–∞–≥ 2: –ü–æ–∫–∞–∑ challenge –∏ –≤–≤–æ–¥ –ø–æ–¥–ø–∏—Å–∏ -->
        {% if challenge_message %}
        <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #f0f4f8;">
            <h3>üìù Challenge –¥–ª—è –ø–æ–¥–ø–∏—Å–∏:</h3>

            <div class="form-group">
                <label>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç:</label>
                <textarea id="challengeField" readonly
                    style="background: #f8f9fa; font-family: 'Courier New', monospace; font-weight: bold;"
                    rows="3">{{ challenge_message }}</textarea>
            </div>

            <button class="btn btn-success" onclick="copyChallenge()" style="width: 100%; margin-bottom: 20px;">
                üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Challenge
            </button>

            <form method="POST">
                <input type="hidden" name="verify_signature" value="1">
                <input type="hidden" name="member_name" value="{{ request.form.member_name }}">
                <input type="hidden" name="challenge_message" value="{{ challenge_message }}">

                <div class="form-group">
                    <label for="signature">–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à—É –ø–æ–¥–ø–∏—Å—å:</label>
                    <textarea id="signature" name="signature" rows="4"
                        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å..." required></textarea>
                </div>

                <button type="submit" class="btn btn-success" style="width: 100%;">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å –∏ –≤–æ–π—Ç–∏
                </button>
            </form>
        </div>
        {% endif %}
    </div>

    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
    <div class="card info-box">
        <h3>üìñ –ö–∞–∫ –≤–æ–π—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ:</h3>
        <ol style="text-align: left; margin: 15px 0; padding-left: 20px;">
            <li><strong>–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –∏–º—è</strong> –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Challenge"</li>
            <li><strong>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ challenge</strong> –∏ –ø–æ–¥–ø–∏—à–∏—Ç–µ –µ–≥–æ –Ω–∞ —Å–≤–æ–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</li>
            <li><strong>–í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å—å</strong> –≤ —Ñ–æ—Ä–º—É –∏ –Ω–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"</li>
        </ol>

        <div style="background: #fffbeb; padding: 15px; border-radius: 10px; margin-top: 15px;">
            <h4 style="color: #d97706;">üîß –ù—É–∂–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏?</h4>
            <p>–°–∫–∞—á–∞–π—Ç–µ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.</p>
            <a href="/signing-tool" class="btn" style="background: #f59e0b; color: white; margin-top: 10px;">
                üõ†Ô∏è –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            </a>
        </div>
    </div>
</div>

<script>
function copyChallenge() {
    const challengeText = document.getElementById('challengeField');
    challengeText.select();
    document.execCommand('copy');
    alert('‚úÖ Challenge —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –¢–µ–ø–µ—Ä—å –ø–æ–¥–ø–∏—à–∏—Ç–µ –µ–≥–æ.');
}
</script>
{% endblock %}